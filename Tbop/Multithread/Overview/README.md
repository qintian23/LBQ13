# 2 多线程并行程序性能分析方法综述
## 2.1 性能调优周期
### 2.1.1 搜集性能数据
### 2.1.2 分析数据并等位性能瓶颈

### 2.1.3 加速比性能定律

要衡量性能调优工作的好坏，就需要一些基本的判定的方法。本节所有介绍的Amdahl定律，就是为了帮助程序员能够量化判定其性能调优工作的好坏。以下为了讨论方便，定义如下参数：令$p$是程序可能被优化的最大加速比；$W$是问题规模（也被称作计算负载、工作负载，定义为给定问题的总计算量），$W_s$是程序中无法或很难被优化的计算负荷，$W$中可比优化部分为$W_p$（显然$W_s+W_p=W$）；$f$是不可优化部分与整体程序的比例（$f=\frac{W_s}{W},W_s=W_1$），$1-f$为可优化部分占程序总体比例\[显然$f+(1-f)=1$\]；$T_s=T_1$为不可优化部分的执行时间，$T_p$为可优化部分的执行时间；$S$为加速比，$E$为效率。

#### 2.1.3.1 Amdahl定理

Amdahl加速定律的基本出发点是：对于整个程序优化后可能达到的加速比取决于程序可优化部分占程序执行时间总体的比例。在此意义下，1967年，Amdahl定义了如下固定负载的加速公式：
$$S=\frac{W_s+W_p}{W_s+\frac{W_p}{p}}$$
为了归一化，$W_s+W_p$可相应地表示为$f+(1-f)$，所以
$$S=\frac{f+(1-f)}{f+\frac{1-f}{p}}=\frac{p}{1+f(p-1)}$$
当$p \to \infty$时，上式极限为：
$$S=\frac{1}{f}$$
这就是著名的Amdahl定律，它意味着即使对程序的可优化部分进行最高限度的性能改进，其对程序整体性能的改进仍然受限于可优化部分占程序总体的比例，而并不随所用优化手段的提高而提高。其可能达到的加速上限为$\frac{1}{f}$，这是一个悲观的结论。

Amdahl定律告诉程序员，如果要使得程序获得更高的性能，就要对程序中更大的部分进行性能调优。Amdahl定律也告诉我们，无论你花多大的时间对程序进行性能优化，总有一部分程序，其性能是很难被提高的。而整个程序可能达到的性能上限却恰恰受制与这一小部分。换句话说，你的程序的性能受限于程序中性能最差的部分。


### 2.1.4 解决性能瓶颈
### 2.1.5 实现优化措施
### 2.1.6 测试

## 2.2 使用Intel VTune进行性能分析
### 2.2.1 性能分析器功能与使用方法
### 2.2.2 性能分析器实验

## 2.3 MKL数学核心函数库

### 2.3.1 MKL数学核心函数库功能与特性
### 2.3.2 MKL数学核心函数库性能
### 2.3.3 MKL数学核心函数库实验

## 2.4 Thread Checker 线程检查器

### 2.4.1 线程检查器功能与使用

### 2.4.2 线程检查器实验

## 2.5 Thread Profiler线程档案器
### 2.5.1 线程档案器功能与使用
### 2.5.2 线程档案器实验
